{"version":3,"file":"SaveMedieFile-24f413a8.js","sources":["../../src/utils/loading.ts","../../src/view/SaveMedieFile.vue"],"sourcesContent":["/**\r\n * loading 加载\r\n */\r\n\r\n// * 进度条加载：https://qiniu.other.cq-wnl.com/1629958394.svga\r\n// * 猫加载：https://qiniu.other.cq-wnl.com/1629958422.svga\r\nconst outDivStyle: any = { // 外层盒子的样式\r\n\t'z-index': 9999,\r\n\twidth: '100vw',\r\n\theight: '100vh',\r\n\tposition: 'fixed',\r\n\ttop: 0,\r\n\tleft: 0,\r\n\tdisplay: 'none'\r\n}\r\nconst style: any = { // 内层盒子的样式\r\n\twidth: '1.6rem',\r\n\theight: '1.6rem',\r\n\tposition: 'absolute',\r\n\tleft: '50%',\r\n\ttop: '50%',\r\n\ttransform: 'translate(-50%,-50%)'\r\n}\r\nconst imgStyle: any = {\r\n\twidth: '100%',\r\n\theight: '100%',\r\n\tdisplay: 'block'\r\n}\r\nclass Loading {\r\n\tprivate status: 0 | 1\r\n\tprivate div: HTMLDivElement\r\n\tprivate inDiv: HTMLDivElement\r\n\tprivate img: HTMLImageElement\r\n\tconstructor() {\r\n\t\tthis.status = 0; // 状态 0暂停 1 开始\r\n\t\tthis.div = document.createElement('div');\r\n\t\tthis.inDiv = document.createElement('div');\r\n\t\tthis.img = document.createElement('img');\r\n\t\tthis.img.src = 'https://qiniu.other.cq-wnl.com/1613800964.gif';\r\n\t\t/** * 设置样式 */\r\n\t\t([{ style: outDivStyle, event: this.div }, { style: style, event: this.inDiv }, { style: imgStyle, event: this.img }])\r\n\t\t\t.forEach(({ style, event }) => {\r\n\t\t\t\tObject.keys(style).forEach((item) => {\r\n\t\t\t\t\tReflect.set(event.style, item, style[item])\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\tthis.inDiv.appendChild(this.img);\r\n\t\tthis.div.appendChild(this.inDiv);\r\n\t\tthis.div.ontouchmove = function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tdocument.body.appendChild(this.div);\r\n\t}\r\n\r\n\t/** * 开始 */\r\n\tstart(opacity = 0) {\r\n\t\tif (this.status === 1) return\r\n\t\tthis.status = 1;\r\n\t\tif (this.div) {\r\n\t\t\tthis.div.style.display = 'block'\r\n\t\t\tthis.div.style.backgroundColor = `rgba(0, 0, 0, ${opacity})`\r\n\t\t}\r\n\t\t// this.div && (this.div.style.display = 'block')\r\n\t}\r\n\r\n\t/** * 结束 */\r\n\tpause() {\r\n\t\tif (this.status === 0) return;\r\n\t\tthis.status = 0;\r\n\t\tthis.div && (this.div.style.display = 'none')\r\n\t}\r\n}\r\n\r\nexport default new Loading();\r\n","<script lang=\"ts\" setup>\r\nimport { xdJsbridge } from \"wnl-xdsdk\"\r\nimport Loading from \"@/utils/loading.ts\"\r\n\r\nconst onDownLoad = (type: \"video\" | \"image\", num: 1 | 2) => {\r\n\tconst list: string[] = []\r\n\r\n\tif (type == \"image\") {\r\n\t\tif (num == 1) {\r\n\t\t\tlist.push(\"https://qiniu.other.cq-wnl.com/1657188889.png\")\r\n\t\t} else {\r\n\t\t\tconst image = [\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1661241654.png\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1657188878.png\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1657188842.png\"\r\n\t\t\t]\r\n\r\n\t\t\tlist.push(...image)\r\n\t\t}\r\n\t} else {\r\n\t\tif (num == 1) {\r\n\t\t\tlist.push(\"https://qiniu.other.cq-wnl.com/1622184906.mp4\")\r\n\t\t} else {\r\n\t\t\tconst video = [\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1622184906.mp4\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1622184906.mp4\"\r\n\t\t\t]\r\n\r\n\t\t\tlist.push(...video)\r\n\t\t}\r\n\t}\r\n\r\n\tconst params = {\r\n\t\tcommand: \"saveMediaFile\",\r\n\t\targs: {\r\n\t\t\ttype: type,\r\n\t\t\tlist,\r\n\t\t\tcallback: \"downloadMediaFile\"\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.log(\"下载参数\", params)\r\n\tLoading.start(0.7)\r\n\txdJsbridge\r\n\t\t.invokeAction<{ status: boolean; errorList?: string[] }>(params)\r\n\t\t.then(({ status, errorList }) => {\r\n\t\t\t// xdJsbridge\r\n\t\t\tconsole.log(\"下载状态\", status)\r\n\t\t\tif (status) {\r\n\t\t\t\txdJsbridge.toast(\"下载成功\")\r\n\t\t\t} else {\r\n\t\t\t\txdJsbridge.toast(\"下载失败\")\r\n\t\t\t\tconsole.log(\"下载失败的文件\", errorList)\r\n\t\t\t}\r\n\r\n\t\t\tLoading.pause()\r\n\t\t})\r\n}\r\n</script>\r\n\r\n<template>\r\n\t<div class='save-medie'>\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('image', 1)\">下载图片（1张）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('image', 2)\">下载图片（3张）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 1)\">下载视频(1个)</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 2)\">下载视频（2个）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 1)\">下载视频(1个)</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 2)\">下载视频（2个）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\t</div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n.save-medie {\r\n\twidth: 100%;\r\n\tmin-height: 100vh;\r\n\tbackground-image: url('../assets/image/1.webp');\r\n\tbackground-size: 100% 100%;\r\n}\r\n</style>\r\n"],"names":["outDivStyle","style","imgStyle","Loading","event","item","e","opacity","Loading$1","onDownLoad","type","num","list","image","video","params","xdJsbridge","status","errorList"],"mappings":"4KAMA,MAAMA,EAAmB,CACxB,UAAW,KACX,MAAO,QACP,OAAQ,QACR,SAAU,QACV,IAAK,EACL,KAAM,EACN,QAAS,MACV,EACMC,EAAa,CAClB,MAAO,SACP,OAAQ,SACR,SAAU,WACV,KAAM,MACN,IAAK,MACL,UAAW,sBACZ,EACMC,EAAgB,CACrB,MAAO,OACP,OAAQ,OACR,QAAS,OACV,EACA,MAAMC,CAAQ,CAKb,aAAc,CACb,KAAK,OAAS,EACT,KAAA,IAAM,SAAS,cAAc,KAAK,EAClC,KAAA,MAAQ,SAAS,cAAc,KAAK,EACpC,KAAA,IAAM,SAAS,cAAc,KAAK,EACvC,KAAK,IAAI,IAAM,gDAEd,CAAC,CAAE,MAAOH,EAAa,MAAO,KAAK,GAAI,EAAG,CAAE,MAAAC,EAAc,MAAO,KAAK,KAAM,EAAG,CAAE,MAAOC,EAAU,MAAO,KAAK,GAAK,CAAA,EAClH,QAAQ,CAAC,CAAE,MAAAD,EAAO,MAAAG,CAAA,IAAY,CAC9B,OAAO,KAAKH,CAAK,EAAE,QAASI,GAAS,CACpC,QAAQ,IAAID,EAAM,MAAOC,EAAMJ,EAAMI,CAAI,CAAC,CAAA,CAC1C,CAAA,CACD,EACG,KAAA,MAAM,YAAY,KAAK,GAAG,EAC1B,KAAA,IAAI,YAAY,KAAK,KAAK,EAC1B,KAAA,IAAI,YAAc,SAAUC,EAAG,CACnCA,EAAE,eAAe,CAAA,EAET,SAAA,KAAK,YAAY,KAAK,GAAG,CACnC,CAGA,MAAMC,EAAU,EAAG,CACd,KAAK,SAAW,IACpB,KAAK,OAAS,EACV,KAAK,MACH,KAAA,IAAI,MAAM,QAAU,QACzB,KAAK,IAAI,MAAM,gBAAkB,iBAAiB,OAAAA,EAAO,MAG3D,CAGA,OAAQ,CACH,KAAK,SAAW,IACpB,KAAK,OAAS,EACd,KAAK,MAAQ,KAAK,IAAI,MAAM,QAAU,QACvC,CACD,CAEA,MAAeC,EAAA,IAAIL,8DCrEnB,MAAAM,EAAA,CAAAC,EAAAC,IAAA,CACC,MAAAC,EAAA,CAAA,EAEA,GAAAF,GAAA,QACC,GAAAC,GAAA,EACCC,EAAA,KAAA,+CAAA,MAAyD,CAEzD,MAAAC,EAAA,CAAc,gDACb,gDACA,+CACA,EAGDD,EAAA,KAAA,GAAAC,CAAA,CAAkB,SAGnBF,GAAA,EACCC,EAAA,KAAA,+CAAA,MAAyD,CAEzD,MAAAE,EAAA,CAAc,gDACb,+CACA,EAGDF,EAAA,KAAA,GAAAE,CAAA,CAAkB,CAIpB,MAAAC,EAAA,CAAe,QAAA,gBACL,KAAA,CACH,KAAAL,EACL,KAAAE,EACA,SAAA,mBACU,CACX,EAGD,QAAA,IAAA,OAAAG,CAAA,EACAZ,EAAA,MAAA,EAAA,EACAa,EAAA,aAAAD,CAAA,EAAA,KAAA,CAAA,CAAA,OAAAE,EAAA,UAAAC,KAAA,CAIE,QAAA,IAAA,OAAAD,CAAA,EACAA,EACCD,EAAA,MAAA,MAAA,GAEAA,EAAA,MAAA,MAAA,EACA,QAAA,IAAA,UAAAE,CAAA,GAGDf,EAAA,MAAA,CAAc,CAAA,CACd"}