{"version":3,"file":"SaveMedieFile-legacy-cb10ccfd.js","sources":["../../src/utils/loading.ts","../../src/view/SaveMedieFile.vue"],"sourcesContent":["/**\r\n * loading 加载\r\n */\r\n\r\n// * 进度条加载：https://qiniu.other.cq-wnl.com/1629958394.svga\r\n// * 猫加载：https://qiniu.other.cq-wnl.com/1629958422.svga\r\nconst outDivStyle: any = { // 外层盒子的样式\r\n\t'z-index': 9999,\r\n\twidth: '100vw',\r\n\theight: '100vh',\r\n\tposition: 'fixed',\r\n\ttop: 0,\r\n\tleft: 0,\r\n\tdisplay: 'none'\r\n}\r\nconst style: any = { // 内层盒子的样式\r\n\twidth: '1.6rem',\r\n\theight: '1.6rem',\r\n\tposition: 'absolute',\r\n\tleft: '50%',\r\n\ttop: '50%',\r\n\ttransform: 'translate(-50%,-50%)'\r\n}\r\nconst imgStyle: any = {\r\n\twidth: '100%',\r\n\theight: '100%',\r\n\tdisplay: 'block'\r\n}\r\nclass Loading {\r\n\tprivate status: 0 | 1\r\n\tprivate div: HTMLDivElement\r\n\tprivate inDiv: HTMLDivElement\r\n\tprivate img: HTMLImageElement\r\n\tconstructor() {\r\n\t\tthis.status = 0; // 状态 0暂停 1 开始\r\n\t\tthis.div = document.createElement('div');\r\n\t\tthis.inDiv = document.createElement('div');\r\n\t\tthis.img = document.createElement('img');\r\n\t\tthis.img.src = 'https://qiniu.other.cq-wnl.com/1613800964.gif';\r\n\t\t/** * 设置样式 */\r\n\t\t([{ style: outDivStyle, event: this.div }, { style: style, event: this.inDiv }, { style: imgStyle, event: this.img }])\r\n\t\t\t.forEach(({ style, event }) => {\r\n\t\t\t\tObject.keys(style).forEach((item) => {\r\n\t\t\t\t\tReflect.set(event.style, item, style[item])\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\tthis.inDiv.appendChild(this.img);\r\n\t\tthis.div.appendChild(this.inDiv);\r\n\t\tthis.div.ontouchmove = function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tdocument.body.appendChild(this.div);\r\n\t}\r\n\r\n\t/** * 开始 */\r\n\tstart(opacity = 0) {\r\n\t\tif (this.status === 1) return\r\n\t\tthis.status = 1;\r\n\t\tif (this.div) {\r\n\t\t\tthis.div.style.display = 'block'\r\n\t\t\tthis.div.style.backgroundColor = `rgba(0, 0, 0, ${opacity})`\r\n\t\t}\r\n\t\t// this.div && (this.div.style.display = 'block')\r\n\t}\r\n\r\n\t/** * 结束 */\r\n\tpause() {\r\n\t\tif (this.status === 0) return;\r\n\t\tthis.status = 0;\r\n\t\tthis.div && (this.div.style.display = 'none')\r\n\t}\r\n}\r\n\r\nexport default new Loading();\r\n","<script lang=\"ts\" setup>\r\nimport { xdJsbridge } from \"wnl-xdsdk\"\r\nimport Loading from \"@/utils/loading.ts\"\r\n\r\nconst onDownLoad = (type: \"video\" | \"image\", num: 1 | 2) => {\r\n\tconst list: string[] = []\r\n\r\n\tif (type == \"image\") {\r\n\t\tif (num == 1) {\r\n\t\t\tlist.push(\"https://qiniu.other.cq-wnl.com/1657188889.png\")\r\n\t\t} else {\r\n\t\t\tconst image = [\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1661241654.png\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1657188878.png\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1657188842.png\"\r\n\t\t\t]\r\n\r\n\t\t\tlist.push(...image)\r\n\t\t}\r\n\t} else {\r\n\t\tif (num == 1) {\r\n\t\t\tlist.push(\"https://qiniu.other.cq-wnl.com/1622184906.mp4\")\r\n\t\t} else {\r\n\t\t\tconst video = [\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1622184906.mp4\",\r\n\t\t\t\t\"https://qiniu.other.cq-wnl.com/1622184906.mp4\"\r\n\t\t\t]\r\n\r\n\t\t\tlist.push(...video)\r\n\t\t}\r\n\t}\r\n\r\n\tconst params = {\r\n\t\tcommand: \"saveMediaFile\",\r\n\t\targs: {\r\n\t\t\ttype: type,\r\n\t\t\tlist,\r\n\t\t\tcallback: \"downloadMediaFile\"\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.log(\"下载参数\", params)\r\n\tLoading.start(0.7)\r\n\txdJsbridge\r\n\t\t.invokeAction<{ status: boolean; errorList?: string[] }>(params)\r\n\t\t.then(({ status, errorList }) => {\r\n\t\t\t// xdJsbridge\r\n\t\t\tconsole.log(\"下载状态\", status)\r\n\t\t\tif (status) {\r\n\t\t\t\txdJsbridge.toast(\"下载成功\")\r\n\t\t\t} else {\r\n\t\t\t\txdJsbridge.toast(\"下载失败\")\r\n\t\t\t\tconsole.log(\"下载失败的文件\", errorList)\r\n\t\t\t}\r\n\r\n\t\t\tLoading.pause()\r\n\t\t})\r\n}\r\n</script>\r\n\r\n<template>\r\n\t<div class='save-medie'>\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('image', 1)\">下载图片（1张）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('image', 2)\">下载图片（3张）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 1)\">下载视频(1个)</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 2)\">下载视频（2个）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\r\n\t\t<van-row>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 1)\">下载视频(1个)</VanButton>\r\n\t\t\t</van-col>\r\n\t\t\t<van-col span=\"8\" offset=\"2\">\r\n\t\t\t\t<VanButton type=\"primary\" @click=\"onDownLoad('video', 2)\">下载视频（2个）</VanButton>\r\n\t\t\t</van-col>\r\n\t\t</van-row>\r\n\t</div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n.save-medie {\r\n\twidth: 100%;\r\n\tmin-height: 100vh;\r\n\tbackground-image: url('../assets/image/1.webp');\r\n\tbackground-size: 100% 100%;\r\n}\r\n</style>\r\n"],"names":["outDivStyle","width","height","position","top","left","display","style","transform","imgStyle","Loading","_classCallCheck","this","status","div","document","createElement","inDiv","img","src","event","forEach","_ref","Object","keys","item","Reflect","set","appendChild","ontouchmove","e","preventDefault","body","key","value","opacity","backgroundColor","concat","Loading$1","onDownLoad","type","num","list","push","apply","params","command","args","callback","console","log","start","xdJsbridge","invokeAction","then","_ref2","errorList","toast","pause"],"mappings":"ukMAMMA,EAAmB,CACxB,UAAW,KACXC,MAAO,QACPC,OAAQ,QACRC,SAAU,QACVC,IAAK,EACLC,KAAM,EACNC,QAAS,QAEJC,EAAa,CAClBN,MAAO,SACPC,OAAQ,SACRC,SAAU,WACVE,KAAM,MACND,IAAK,MACLI,UAAW,wBAENC,EAAgB,CACrBR,MAAO,OACPC,OAAQ,OACRI,QAAS,SAEJI,EAKL,WAAA,SAAAA,iGAAcC,CAAAC,KAAAF,GACbE,KAAKC,OAAS,EACTD,KAAAE,IAAMC,SAASC,cAAc,OAC7BJ,KAAAK,MAAQF,SAASC,cAAc,OAC/BJ,KAAAM,IAAMH,SAASC,cAAc,OAClCJ,KAAKM,IAAIC,IAAM,gDAEd,CAAC,CAAEZ,MAAOP,EAAaoB,MAAOR,KAAKE,KAAO,CAAEP,MAAAA,EAAca,MAAOR,KAAKK,OAAS,CAAEV,MAAOE,EAAUW,MAAOR,KAAKM,MAC7GG,SAAQ,SAAAC,GAAGf,IAAAA,EAAOe,EAAPf,MAAOa,EAAAE,EAAAF,MAClBG,OAAOC,KAAKjB,GAAOc,SAAQ,SAACI,GAC3BC,QAAQC,IAAIP,EAAMb,MAAOkB,EAAMlB,EAAMkB,GAAK,GAC1C,IAEEb,KAAAK,MAAMW,YAAYhB,KAAKM,KACvBN,KAAAE,IAAIc,YAAYhB,KAAKK,OACrBL,KAAAE,IAAIe,YAAc,SAAUC,GAChCA,EAAEC,gBAAe,EAEThB,SAAAiB,KAAKJ,YAAYhB,KAAKE,IAChC,WAkBAJ,SAlBAA,IAAA,CAAA,CAAAuB,IAAA,QAAAC,MAGA,eAAMC,sDAAU,GAAA,EACK,IAAhBvB,KAAKC,SACTD,KAAKC,OAAS,EACVD,KAAKE,MACHF,KAAAE,IAAIP,MAAMD,QAAU,QACzBM,KAAKE,IAAIP,MAAM6B,gBAAkBC,iBAAAA,OAAiBF,EAAO,MAG3D,GAAA,CAAAF,IAAA,QAAAC,MAGA,WACqB,IAAhBtB,KAAKC,SACTD,KAAKC,OAAS,EACdD,KAAKE,MAAQF,KAAKE,IAAIP,MAAMD,QAAU,QACvC,qFAAAI,CAGc,CAxCd,GAwCc4B,EAAA,IAAI5B,mFCrEnB,IAAA6B,EAAA,SAAAC,EAAAC,GACC,IAAAC,EAAA,GAEA,GAAA,SAAAF,EACC,GAAA,GAAAC,EACCC,EAAAC,KAAA,qDAAyD,CAQzDD,EAAAC,KAAAC,MAAAF,EANA,CAAc,gDACb,gDACA,iDAIiB,MAGnB,GAAA,GAAAD,EACCC,EAAAC,KAAA,qDAAyD,CAOzDD,EAAAC,KAAAC,MAAAF,EALA,CAAc,gDACb,iDAIiB,CAIpB,IAAAG,EAAA,CAAeC,QAAA,gBACLC,KAAA,CACHP,KAAAA,EACLE,KAAAA,EACAM,SAAA,sBAKFC,QAAAC,IAAA,OAAAL,GACAnC,EAAAyC,MAAA,IACAC,EAAAC,aAAAR,GAAAS,MAAA,SAAAC,GAAA,IAAA1C,EAAA0C,EAAA1C,OAAA2C,EAAAD,EAAAC,UAIEP,QAAAC,IAAA,OAAArC,GACAA,EACCuC,EAAAK,MAAA,SAEAL,EAAAK,MAAA,QACAR,QAAAC,IAAA,UAAAM,IAGD9C,EAAAgD,OAAc,GACd"}